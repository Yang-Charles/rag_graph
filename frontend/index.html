<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>RAG Graph Demo</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      body { font-family: Arial, sans-serif; margin: 20px }
      .results { display:flex; gap:20px }
      pre { background:#f6f6f6; padding:10px }
    </style>
  </head>
  <body>
    <div id="app">
      <h2>Multimodal RAG Search</h2>
      <form @submit.prevent="onSearch">
        <input v-model="query" placeholder="输入查询" style="width:400px" />
        <input type="file" @change="onFile" />
        <label style="margin-left:10px">Top-k:
          <input type="number" v-model.number="topk" min="1" max="50" style="width:60px" />
        </label>
        <div style="margin-top:8px">
          检索方法:
          <label><input type="checkbox" v-model="selected" value="fulltext" /> 全文</label>
          <label><input type="checkbox" v-model="selected" value="semantic" /> 语义</label>
          <label><input type="checkbox" v-model="selected" value="image" /> 图像</label>
          <label><input type="checkbox" v-model="selected" value="kg" /> 知识图谱</label>
          <label><input type="checkbox" v-model="selected" value="fused" /> 混合</label>
        </div>
        <button type="submit" style="margin-top:8px">Search</button>
      </form>

      <div class="results" v-if="resp">
        <div style="flex:1">
          <h3>Per-method Results</h3>
          <div style="display:flex;gap:10px;flex-wrap:wrap">
            <div v-for="m in displayMethods" :key="m" style="min-width:200px; border:1px solid #ddd; padding:8px">
              <strong>{{ m }}</strong>
              <ol>
                <li v-for="item in (resp[m] || []).slice(0, topk)" :key="JSON.stringify(item)">
                  <span>{{ formatItem(item) }}</span>
                </li>
              </ol>
            </div>
          </div>
        </div>
        <div style="flex:1">
          <h3>Top-k Comparison</h3>
          <canvas id="compareChart" width="400" height="300"></canvas>
          <div style="margin-top:8px">
            <label><input type="checkbox" v-model="showCounts" /> Show counts in chart</label>
          </div>
        </div>
      </div>
    </div>

    <script src="app.js"></script>
  </body>
</html>
